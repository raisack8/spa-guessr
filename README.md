# SpaGuessr

æ—¥æœ¬ã®æ¸©æ³‰å®¿ã®ç”»åƒã‚’è¦‹ã¦ã€æ‰€åœ¨åœ°ã‚’æ¨æ¸¬ã™ã‚‹Webã‚²ãƒ¼ãƒ ã€‚GeoGuessrã®æ¸©æ³‰ç‰ˆã§ã™ã€‚

## ğŸ¯ æ¦‚è¦

- æ¸©æ³‰å®¿ã®ç”»åƒ6æšã‚’5ç§’ãšã¤è¡¨ç¤º
- è¡›æ˜Ÿç”»åƒã‹ã‚‰ã®ãƒ’ãƒ³ãƒˆ
- æ—¥æœ¬åœ°å›³ã§ãƒ”ãƒ³ã‚’åˆºã—ã¦å›ç­”
- è·é›¢ã¨æ™‚é–“ã«ã‚ˆã‚‹å¾—ç‚¹ã‚·ã‚¹ãƒ†ãƒ 
- æ¥½å¤©ãƒˆãƒ©ãƒ™ãƒ«ã®ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆé€£æº

## ğŸš€ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### é–‹ç™ºç’°å¢ƒ
- **ã‚³ãƒ³ãƒ†ãƒŠ**: Docker + Docker Compose
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQL 15 (Docker)
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: Redis 7 (Docker)
- **ãƒ¡ãƒ¼ãƒ«**: Mailhog (é–‹ç™ºç”¨SMTPã‚µãƒ¼ãƒãƒ¼)

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- **Frontend & Backend**: Next.js 14 (App Router)
- **Database ORM**: Drizzle ORM
- **Styling**: Tailwind CSS + shadcn/ui
- **Maps**: Mapbox GL JS
- **3D**: Three.js

### æœ¬ç•ªç’°å¢ƒ
- **Database**: Neon PostgreSQL
- **Hosting**: Vercel
- **Storage**: Vercel Blob

## ğŸ“‹ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³
```bash
git clone <repository-url>
cd spaguessr
```

### 2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
```bash
cp .env.example .env.local
# å¿…è¦ãªAPI keyã‚’è¨­å®š
```

### 3. Dockerç’°å¢ƒã®èµ·å‹•
```bash
# é–‹ç™ºç’°å¢ƒå…¨ä½“ã‚’èµ·å‹•ï¼ˆDBã€Redisç­‰ï¼‰
docker-compose up -d

# åˆå›ã®ã¿ï¼šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åˆæœŸåŒ–
npm run db:generate
npm run db:push
npm run db:seed  # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥
```

### 4. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
```bash
npm install
npm run dev
```

### 5. ã‚¢ã‚¯ã‚»ã‚¹
- **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: http://localhost:3000
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†**: http://localhost:5432 (PostgreSQL)
- **Drizzle Studio**: http://localhost:4983
- **Mailhog** (ãƒ¡ãƒ¼ãƒ«ç¢ºèª): http://localhost:8025

## ğŸ—‚ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
src/
â”œâ”€â”€ app/                 # Next.js App Router
â”‚   â”œâ”€â”€ api/            # API routes
â”‚   â”œâ”€â”€ game/           # ã‚²ãƒ¼ãƒ ç”»é¢
â”‚   â””â”€â”€ rankings/       # ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”»é¢
â”œâ”€â”€ components/         # Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ game/          # ã‚²ãƒ¼ãƒ é–¢é€£
â”‚   â”œâ”€â”€ map/           # åœ°å›³é–¢é€£
â”‚   â””â”€â”€ ui/            # UIéƒ¨å“
â”œâ”€â”€ lib/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ db/            # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
â”‚   â””â”€â”€ utils/         # å…±é€šé–¢æ•°
â””â”€â”€ types/             # TypeScriptå‹å®šç¾©
```

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹æˆ

### ãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«
- `m_users`: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
- `m_spas`: æ¸©æ³‰å®¿æƒ…å ±

### ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«
- `t_game_sessions`: ã‚²ãƒ¼ãƒ ã‚»ãƒƒã‚·ãƒ§ãƒ³
- `t_saved_spas`: ä¿å­˜ã•ã‚ŒãŸå®¿
- `t_weekly_rankings`: é€±é–“ãƒ©ãƒ³ã‚­ãƒ³ã‚°

## ğŸ® ã‚²ãƒ¼ãƒ ãƒ•ãƒ­ãƒ¼

1. ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³æŠ¼ä¸‹
2. æ¸©æ³‰å®¿ç”»åƒã‚’6æšè¡¨ç¤ºï¼ˆå„5ç§’ï¼‰
3. è¡›æ˜Ÿç”»åƒãƒ’ãƒ³ãƒˆè¡¨ç¤º
4. æ—¥æœ¬åœ°å›³ã§ãƒ”ãƒ³ã‚’åˆºã™
5. è·é›¢ã¨æ™‚é–“ã§å¾—ç‚¹è¨ˆç®—
6. ç­”ãˆåˆã‚ã›ãƒ»ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒªãƒ³ã‚¯è¡¨ç¤º

## ğŸ† å¾—ç‚¹ã‚·ã‚¹ãƒ†ãƒ 

```javascript
// åŸºæœ¬å¾—ç‚¹ï¼ˆè·é›¢ã«ã‚ˆã‚‹ï¼‰
const baseScore = Math.max(0, 1000 - (distance_km * 10));

// æ™‚é–“å€ç‡ï¼ˆæ—©ã„ã»ã©é«˜å€ç‡ï¼‰
const timeMultiplier = Math.max(1.0, 2.0 - (time_seconds / 60) * 0.1);

// æœ€çµ‚å¾—ç‚¹
const finalScore = Math.floor(baseScore * timeMultiplier);
```

## ğŸ”§ é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

### Dockeré–¢é€£
```bash
# é–‹ç™ºç’°å¢ƒã®èµ·å‹•
docker-compose up -d

# é–‹ç™ºç’°å¢ƒã®åœæ­¢
docker-compose down

# ãƒ­ã‚°ã®ç¢ºèª
docker-compose logs -f

# ã‚³ãƒ³ãƒ†ãƒŠã®å†ãƒ“ãƒ«ãƒ‰
docker-compose build --no-cache
```

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼
npm run dev

# ãƒ“ãƒ«ãƒ‰
npm run build
npm run start
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆ
npm run db:generate

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
npm run db:push

# ã‚·ãƒ¼ãƒ‰å®Ÿè¡Œ
npm run db:seed

# Drizzle Studioï¼ˆDBç®¡ç†ç”»é¢ï¼‰
npm run db:studio
```

### ãƒ†ã‚¹ãƒˆ
```bash
# Unit tests
npm run test
npm run test:watch

# E2E tests (Playwright)
npm run test:e2e
npm run test:e2e:ui
```

## ğŸŒŸ ä¸»ãªæ©Ÿèƒ½

- **ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤**: ç”»åƒã‹ã‚‰æ¸©æ³‰åœ°ã‚’æ¨æ¸¬
- **ãƒ©ãƒ³ã‚­ãƒ³ã‚°**: é€±é–“ãƒ»å®¿åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°
- **ä¿å­˜æ©Ÿèƒ½**: æ°—ã«å…¥ã£ãŸå®¿ã‚’ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯
- **ã‚¢ãƒã‚¿ãƒ¼**: ãƒã‚¤ãƒ³ãƒˆã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- **ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆ**: æ¥½å¤©ãƒˆãƒ©ãƒ™ãƒ«é€£æº

## ğŸ“– è©³ç´°ä»•æ§˜

è©³ç´°ãªä»•æ§˜æ›¸ã¯ [SPEC.md](./SPEC.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤

Vercelã«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šæ¸ˆã¿ã€‚`main`ãƒ–ãƒ©ãƒ³ãƒã«pushã™ã‚‹ã¨è‡ªå‹•ã§ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™ã€‚

## ğŸ¤ é–‹ç™ºã‚¬ã‚¤ãƒ‰

1. **Phase 1**: åŸºæœ¬æ©Ÿèƒ½ï¼ˆMVPï¼‰
2. **Phase 2**: ãƒ‡ãƒ¼ã‚¿åé›†ãƒ»æ‹¡å¼µ
3. **Phase 3**: UXå‘ä¸Šãƒ»åç›ŠåŒ–
4. **Phase 4**: é«˜åº¦ãªæ©Ÿèƒ½

å„ãƒ•ã‚§ãƒ¼ã‚ºã®è©³ç´°ã¯ [SPEC.md](./SPEC.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸ“ License

MIT License